# iOS App Guide

TFD Builds can run as a native iPhone app using [Capacitor](https://capacitorjs.com/). The same web codebase is used for both the website and the iOS app — no separate code to maintain.

## Prerequisites

- **macOS** with [Xcode](https://developer.apple.com/xcode/) installed (15.0+)
- **Node.js** 22+ and npm
- An [Apple Developer account](https://developer.apple.com/) (free for device testing, paid for App Store distribution)

## Quick Start

```bash
# 1. Install dependencies
npm install

# 2. Build the web app, sync to iOS, and open Xcode
npm run cap:build
```

This single command builds the web app, copies it into the native iOS project, and opens Xcode where you can run the app on a simulator or device.

## Available Scripts

| Script | Description |
|--------|-------------|
| `npm run cap:sync` | Build the web app and sync changes to the iOS project |
| `npm run cap:open` | Open the iOS project in Xcode |
| `npm run cap:build` | Build, sync, and open Xcode (full workflow) |

## Development Workflow

### Making Changes

1. Edit your web code in `src/` as usual
2. Run `npm run cap:sync` to rebuild and copy changes to the iOS project
3. Run the app from Xcode to see your changes on a simulator or device

### Running on a Simulator

1. Run `npm run cap:build` to open the project in Xcode
2. Select a simulator (e.g., iPhone 16) from the device dropdown
3. Click the **Run** button (▶) or press `Cmd+R`

### Running on a Physical Device

1. Connect your iPhone via USB
2. In Xcode, select your device from the device dropdown
3. You may need to trust your developer certificate on the device:
   - On iPhone: **Settings → General → VPN & Device Management**
4. Click **Run** in Xcode

## Project Structure

```
ios/
├── App/
│   ├── App/              # Native iOS app files
│   │   ├── AppDelegate.swift
│   │   ├── Assets.xcassets/  # App icons
│   │   ├── Info.plist
│   │   └── public/       # Built web assets (git-ignored, generated by cap sync)
│   └── App.xcodeproj     # Xcode project file
└── CapApp-SPM/           # Swift Package Manager dependencies
```

## Customization

### App Icon

Replace the app icon in `ios/App/App/Assets.xcassets/AppIcon.appiconset/`. You need a 1024×1024 PNG image. Xcode can generate all required sizes from this single image.

### App ID

The app identifier is configured in `capacitor.config.json`:

```json
{
  "appId": "com.tfdbuilds.app"
}
```

Change this to match your Apple Developer account's bundle identifier if publishing to the App Store.

### Splash Screen & Status Bar

The status bar style is set to `black-translucent` in `index.html` for a seamless dark-themed look. Additional native splash screen configuration can be done in `ios/App/App/Assets.xcassets/Splash.imageset/`.

## App Store Distribution

To publish to the App Store:

1. Enroll in the [Apple Developer Program](https://developer.apple.com/programs/) ($99/year)
2. Configure signing in Xcode: **Signing & Capabilities → Team**
3. Set the version and build number in Xcode's **General** tab
4. **Product → Archive** to create a release build
5. Use **Window → Organizer** to upload to App Store Connect

## Troubleshooting

### "No such module 'Capacitor'"
Run `npm run cap:sync` to ensure the iOS project has the latest dependencies.

### Web assets not updating
Make sure to run `npm run cap:sync` (not just `npm run build`) — this builds the web app AND copies it into the iOS project.

### API keys not working in the iOS app
The iOS app loads the same web code, so API keys configured via `localStorage` in the browser settings UI will work. Environment variables (`VITE_*`) are baked in at build time.
